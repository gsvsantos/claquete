<div *transloco="let t">
  <div class="search-container" [class.has-value]="queryText$ | async">
    <input
      class="search-input"
      [formControl]="searchControl"
      [placeholder]="t('search.placeholder')"
      autocomplete="on"
      (keyup.enter)="search()"
      (keyup.escape)="resetSearchControl()"
    />
    <gs-buttons
      class="btn-clear"
      [buttonType]="buttonType.Default"
      text=""
      bootstrapIcon="bi-x"
      color="transparent"
      hoverColor="transparent"
      [transitionProperties]="['background-color', 'box-shadow']"
      [transitionDuration]="200"
      [transitionEase]="'ease-in-out'"
      (click)="resetSearchControl()"
    ></gs-buttons>
    <gs-buttons
      class="btn-search"
      [buttonType]="buttonType.Default"
      text=""
      bootstrapIcon="bi-search"
      color="transparent"
      hoverColor="transparent"
      [transitionProperties]="['background-color', 'box-shadow']"
      [transitionDuration]="200"
      [transitionEase]="'ease-in-out'"
      (click)="search()"
    ></gs-buttons>
  </div>

  @if (isLoading$ | async) {
    <p class="hint">{{ t('common.messages.loading') }}</p>
  } @else if (isQueryTooShort$ | async) {
    <p class="hint">{{ t('common.messages.type-at-least', { minimumLength: minimumLength }) }}</p>
  }

  @if (showEmptyState$ | async) {
    <ul class="results">
      <li class="empty">{{ t('common.messages.nothing-found') }}</li>
    </ul>
  } @else if (hasResults$ | async) {
    <ul class="results">
      @for (item of (viewItems$ | async)!; track item.id) {
        <li class="result-item" [routerLink]="item.routerLink" (click)="resetSearchControl()">
          @if (item.posterUrl) {
            <img class="poster" [src]="item.posterUrl" alt="" width="46" height="69" />
          }
          <div class="info">
            <div class="title">
              <strong>{{ item.title }}</strong>
              <span class="badge">{{
                item.mediaType === 'movie' ? t('search.badge.movie') : t('search.badge.tv-show')
              }}</span>
            </div>
            @if (item.subtitle) {
              <div class="subtitle">{{ item.subtitle }}</div>
            }
          </div>
        </li>
      }
    </ul>
  }
</div>
